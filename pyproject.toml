[tool.black]
# Default line-length, but use explicit value here since used for isort & ruff
line-length = 88
target-version = ['py36']

[tool.codespell]
# codespell doesn't appear to support skip as a list?
# unicode_emojis: words are defined externally
# test_themes: uses wrong words as part of a theme syntax test
# test_boxes: uses word prefixes as part of an autocomplete test
# test_messages: uses IST as Indian time zone, which is confused for IS/IT/ITS/IT'S/etc
skip = "zulipterminal/unicode_emojis.py,tests/config/test_themes.py,tests/ui_tools/test_boxes.py,tests/ui_tools/test_messages.py"

[tool.isort]
py_version = 37
# Use black for the default settings (with adjustments listed below)
profile = "black"
# For compatibility with 'black' we'd want to set this consistently
line_length = 88
atomic = true
# This is compatible with black, but we could remove it
lines_after_imports = 2

[tool.pytest.ini_options]
minversion = "6.0"
xfail_strict = true
addopts = "-rxXs --cov=zulipterminal --no-cov-on-fail"
filterwarnings = [
    # distutils: imp module is deprecated in favor of importlib
    # * python3.6/3.7/3.8
    "ignore::DeprecationWarning:distutils.*:",
    # bs4: ABCs must be imported from collections.abc, not collections, from python3.9
    # * python 3.7/3.8
    "ignore::DeprecationWarning:bs4.*:",
]

[tool.ruff]
line-length = 88
target-version = "py37"
exclude = [
    ".git",
    "__pycache__",
    "build",
    "dist",
    "zt_venv",
]
ignore = [
    "ANN101", # Missing type annotation for `self` in method
    "ANN102", # Missing type annotation for `cls` in classmethod
    "ANN401", # Dynamically typed expressions (typing.Any) are disallowed
    "B006", # Do not use mutable data structures for argument defaults
    "B007", # Loop control variable not used within the loop body [informative!]
    "C408", # Unnecessary 'dict' call (rewrite as a literal)
    "UP015", # Unnecessary open mode parameters [informative?]
]
select = [
    "ANN", # Annotations
    "B", # Bugbear
    "C4", # Comprehensions
    "E", # Error (pycodestyle)
    "F", # pyFlakes
    "G", # loGging
    "PGH", # PyGrep Hooks
    "PIE", # pie (miscellaneous)
    "PLC", # pylint convention
    "PLE", # pylint error
    "RSE", # RaiSE
    "PLW", # pylint warning
    "RUF100", # Checks noqa rules are used
    "T20", # prinT present
    "W", # Warnings (pycodestyle)
    "UP", # pyUPgrade
    "YTT", # Year TwentyTwenty (flake8-2020), sys.version checks
]
[tool.ruff.per-file-ignores]
# ANN: We don't consider this worth typing
"setup.py" = ["ANN"]
# ANN: These test files are not yet typed
"tests/model/test_model.py" = ["ANN"]
"tests/ui/test_ui_tools.py" = ["ANN"]
"tests/ui_tools/test_messages.py" = ["ANN"]
# ANN: This tool is an old variation from zulip/zulip and is only updated where necessary
"tools/lister.py" = ["ANN"]
# E501: Ignore length in tools for now (and otherwise where noqa specified)
# T20: Expect print output from CLI from tools
"tools/*" = ["E501", "T20"]
# T20: Expect print output from CLI from run.py
"zulipterminal/cli/run.py" = ["T20"]
